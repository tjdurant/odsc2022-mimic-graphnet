####################################################
# Create fake data to use in model create for dev &
# testing when MIMIC data are not available.
# Highly unrealistic data generation - each dx code
# has a 10% chance of being positive, randomly 
# chosen sex, age, race, care site, and length of
# stay (LOS). LOS ranges from 1-12 days. Each row
# is a visit.
####################################################

import os
import random

if not os.path.exists("data"):
    os.makedirs("data")

# Change this to set the number of records to create
visits_to_generate = 25000

# CSV includes visit ID, demographics, LOS, bool of whether LOS is >=6 and bool for each diagnosis (dx)
header = ["visit_occurrence_id","gender","care_site_source_value","myrace","myage","los6","my_los","868.04","816.01","041.4","455.0","786.05","426.12","714.0","791.9","424.2","558.9","V45.82","579.0","285.1","730.27","784.7","934.8","707.12","442.84","V15.52","780.09","188.8","362.50","522.5","530.7","753.12","V12.79","338.3","041.3","394.1","569.69","789.09","307.9","909.2","282.5","518.0","453.41","296.33","414.00","112.84","112.89","305.90","250.62","811.00","959.01","296.20","345.10","342.90","V10.41","998.32","427.81","286.3","478.29","511.8","521.00","811.09","287.31","807.07","V49.62","519.1","E911","348.5","276.69","285.3","458.9","873.20","303.91","357.6","999.2","535.40","362.01","428.30","288.0","V53.32","682.1","E935.2","812.09","V62.84","423.9","728.85","281.0","453.42","295.30","536.3","070.30","338.18","V12.54","295.32","V45.79","532.90","275.49","733.13","V42.82","440.0","482.41","573.9","447.1","E916","283.9","290.0","E942.4","250.00","729.81","933.1","995.90","410.72","V64.41","787.29","398.90","455.5","218.9","304.20","296.7","411.1","284.1","309.28","443.0","431","300.4","787.6","536.49","251.2","813.44","451.84","153.3","162.8","V42.83","711.01","276.3","348.30","578.9","787.2","576.8","E823.0","783.21","790.29","E939.8","729.1","616.10","518.51","196.2","E960.0","250.41","E912","V11.3","999.31","V49.73","348.8","423.3","305.20","873.63","331.0","969.3","250.10","433.10","511.9","V15.3","348.39","935.1","567.2","805.2","707.04","788.1","V02.59","070.32","682.7","197.8","758.0","344.1","537.9","E878.5","491.20","401.1","707.23","731.0","429.71","428.0","319","V45.81","808.43","V10.79","608.4","491.21","041.09","443.29","E854.3","825.25","369.00","V87.41","274.0","519.09","342.00","V10.02","V44.6","285.22","998.81","478.30","681.10","823.02","198.1","707.13","V10.06","438.20","553.1","V46.11","870.0","410.12","V15.51","793.1","733.09","V15.1","720.0","808.41","V58.65","786.30","292.0","995.94","E950.3","427.0","564.1","250.50","790.4","261","788.20","868.03","E815.0","736.79","922.1","V55.1","V42.0","425.9","614.6","304.01","780.01","785.52","786.50","250.70","344.00","E901.0","398.91","535.01","365.9","873.8","730.07","368.8","428.20","458.8","344.89","438.13","991.6","425.8","535.60","555.9","569.81","327.23","492.8","823.82","276.2","038.43","278.01","607.84","197.5","310.2","275.2","V10.42","916.0","790.01","V15.84","038.8","274.9","573.8","V10.87","518.89","719.45","V49.76","V45.86","276.0","355.8","600.00","715.98","338.4","304.00","518.82","E884.3","397.0","789.59","E812.2","428.23","438.0","709.8","340","972.6","054.9","998.59","860.0","198.5","110.5","413.9","458.0","V45.01","593.81","V15.82","396.3","711.06","996.69","338.12","415.19","288.60","511.81","996.72","881.01","493.22","438.82","112.1","426.89","244.0","227.0","305.93","E929.0","560.89","301.7","808.0","716.90","511.0","E956","707.05","311","852.01","620.2","567.29","585.2","794.8","575.8","196.1","781.2","E816.0","342.91","535.10","965.4","745.5","527.2","421.0","790.7","E878.4","737.10","041.02","785.0","873.42","999.8","V49.75","466.0","E934.2","E928.9","585.4","291.81","787.22","V10.07","301.83","323.9","456.21","865.00","203.00","V43.65","366.9","V12.55","807.05","E937.9","289.59","E941.3","424.0","596.8","453.8","054.10","531.90","535.51","823.00","E950.4","784.3","117.9","958.4","919.0","998.13","V46.2","784.0","386.11","491.22","782.0","442.3","560.1","274.01","530.6","873.64","294.8","304.10","873.43","910.0","578.1","997.02","707.22","996.73","724.5","733.19","356.9","478.6","197.2","789.01","996.74","V12.71","433.20","415.11","537.0","810.00","492.0","E928.8","E942.0","V10.82","444.21","719.06","786.8","250.60","041.49","593.2","285.29","331.3","729.5","V45.2","997.5","V85.43","781.3","596.54","382.9","455.6","821.23","041.84","041.04","807.4","995.1","573.0","416.2","250.53","438.19","459.2","277.30","780.6","117.3","288.03","795.79","E929.3","V10.43","V13.01","292.81","309.0","428.31","530.3","810.03","250.43","V42.2","V12.04","296.30","379.41","724.2","E939.3","110.1","608.86","459.0","530.12","250.61","425.1","174.8","038.2","324.1","359.81","E849.5","444.0","593.9","V13.51","266.2","707.09","427.69","696.1","V45.73","305.01","453.84","805.4","557.1","438.11","E849.7","557.0","567.22","440.22","996.79","970.8","V58.83","550.90","782.3","252.00","276.5","284.89","790.6","788.29","V10.85","241.1","441.2","354.0","411.89","596.0","E870.6","599.72","801.06","041.11","722.4","V58.69","593.4","881.00","571.6","860.4","183.0","V44.2","255.4","730.18","593.89","295.70","789.5","682.3","V15.81","566","112.5","V53.31","598.9","333.0","252.01","349.0","478.31","197.0","V45.1","355.9","780.4","790.5","279.52","112.0","721.0","348.1","427.1","E950.0","423.2","780.39","E915","294.20","E935.8","457.1","V08","997.79","996.62","733.42","410.71","695.89","197.7","293.9","455.2","562.12","444.81","440.24","443.9","934.1","599.71","796.3","V10.89","281.1","V45.02","E879.2","305.50","530.11","584.8","682.2","E888.8","453.86","588.1","288.00","574.50","263.9","793.11","E884.2","997.91","518.4","707.10","276.52","289.0","510.9","882.0","285.8","305.63","998.89","518.1","420.90","715.96","V15.41","801.26","861.21","482.9","451.82","731.3","V43.3","599.70","V10.09","572.8","573.3","693.0","707.06","V12.72","276.51","572.0","286.7","427.89","454.9","348.31","708.0","996.86","446.4","348.4","435.9","786.52","599.0","580.89","V12.59","455.8","571.0","275.41","287.4","336.3","V10.52","863.89","412","300.3","584.9","428.40","722.71","707.03","E942.6","788.5","487.1","786.1","305.70","733.90","571.1","V10.05","434.90","041.19","924.00","V85.4","728.87","414.8","996.49","257.2","572.3","997.09","303.93","E930.8","784.59","041.01","428.32","V58.67","532.40","E917.9","575.11","789.51","482.2","780.57","V45.61","283.0","368.2","V27.0","427.5","426.3","350.1","808.2","530.0","V10.47","799.02","907.0","251.1","112.2","907.2","V55.4","825.0","V16.1","284.8","041.7","796.2","276.8","457.8","574.10","807.08","453.40","707.20","918.1","357.5","426.0","E880.9","E816.2","372.30","053.9","453.81","E849.0","349.82","V10.21","733.00","250.12","564.00","786.2","E879.4","496","250.52","429.9","V85.0","724.00","535.30","512.1","784.5","519.19","780.97","295.90","E812.1","189.0","707.19","998.12","428.22","440.8","719.46","530.89","997.62","V45.3","584.5","588.81","272.1","759.89","038.0","562.11","781.8","867.0","E850.2","253.5","250.71","425.4","440.4","969.4","997.49","070.70","276.9","238.4","789.00","787.91","294.11","V55.0","293.0","724.4","443.81","577.8","995.93","198.7","553.3","569.5","730.08","517.8","428.21","401.9","721.1","E814.7","725","571.2","530.19","402.91","V17.3","403.10","E885.9","287.49","807.02","305.21","570","389.9","V58.61","253.6","477.9","569.49","227.3","V49.83","V45.88","611.72","780.62","788.30","824.8","444.22","E826.1","785.50","E930.5","V44.4","821.01","331.4","695.3","519.02","305.00","305.1","338.11","695.4","249.00","440.1","289.81","575.10","788.41","585.5","205.00","730.28","577.1","275.42","305.60","556.9","592.0","518.3","250.40","443.21","493.20","427.41","157.0","852.00","965.02","V64.2","V55.2","V45.72","287.5","459.81","E947.8","138","198.3","802.8","438.89","789.2","783.0","278.00","E930.0","282.49","174.9","E878.2","731.8","787.01","V58.66","518.84","V10.04","473.9","272.0","482.42","519.4","864.05","433.30","198.89","038.49","416.8","536.42","588.89","277.4","305.91","250.83","707.14","728.89","202.80","345.40","008.8","244.9","560.81","707.21","396.0","913.0","135","351.0","482.0","802.6","568.0","296.89","873.0","414.02","304.70","V42.81","E878.3","241.0","786.03","322.9","423.1","289.9","707.02","437.0","276.6","555.1","342.92","338.19","458.29","455.3","537.89","585","737.30","271.3","V12.53","715.35","995.92","429.3","240.9","535.41","600.01","784.51","920","451.89","280.0","E816.1","V10.46","410.92","997.39","531.40","719.7","729.72","996.66","569.85","298.9","V17.49","444.89","250.02","430","724.3","501","281.9","V45.77","112.3","E936.3","366.8","198.2","E849.9","786.09","V88.01","250.82","276.7","575.0","997.3","427.32","507.0","296.80","626.2","359.4","V60.0","568.89","414.2","785.51","481","922.32","698.9","788.39","357.2","426.11","E879.0","518.83","196.0","253.2","V15.88","403.90","998.2","782.4","V70.7","852.21","579.3","578.0","199.1","462","722.93","041.6","860.2","582.81","V12.01","980.0","785.4","079.99","V66.7","710.2","434.11","707.8","E879.8","577.0","277.3","965.00","567.9","E937.8","738.4","317","305.40","250.42","452","996.81","V49.86","781.94","724.02","494.1","378.51","564.09","576.1","482.83","780.79","E878.1","348.89","E947.9","185","305.51","786.6","V14.0","238.75","790.92","553.20","359.9","995.0","789.06","E882","716.96","E879.9","041.86","780.2","692.9","E968.9","304.21","369.60","510.0","053.19","997.69","279.00","V14.8","416.0","583.9","583.81","E942.9","569.83","242.90","V44.0","569.3","E813.6","V09.80","386.00","338.29","729.92","599.7","530.10","424.90","491.9","962.3","E884.4","715.36","780.61","250.63","E932.0","535.50","078.5","780.60","244.8","423.0","515","294.9","333.1","V55.3","482.82","041.85","290.40","V44.1","E936.1","696.0","273.1","785.59","729.89","514","786.06","V45.71","494.0","530.85","336.1","530.5","958.8","250.80","429.83","591","999.9","426.4","346.90","275.0","568.81","273.8","333.2","799.4","787.21","E879.6","303.90","781.0","262","710.0","333.99","280.9","486","792.1","780.1","V02.54","V10.11","358.00","427.31","682.6","783.7","722.10","V85.1","512.8","577.9","E931.0","296.90","V10.51","574.51","368.46","780.65","250.81","E853.2","728.88","996.01","394.2","E939.0","795.5","E878.0","429.89","518.5","442.2","847.0","268.9","294.10","E942.1","E812.0","211.2","786.59","824.4","807.2","V45.11","410.42","866.02","263.0","997.31","533.90","574.20","V16.3","738.19","197.6","530.81","528.9","874.8","560.9","E870.8","562.10","787.20","E850.4","343.9","998.6","707.25","572.4","707.07","713.5","535.61","242.00","V07.1","998.11","807.03","255.41","351.8","E878.8","569.89","784.2","715.95","110.3","965.09","008.45","E878.6","922.2","V85.41","255.9","576.2","E870.0","998.83","998.31","V45.85","996.1","461.9","250.51","372.72","333.94","197.4","E980.0","403.91","E884.9","204.10","V09.0","537.3","710.1","E933.1","536.8","196.3","V18.0","V16.0","E932.3","441.4","435.8","571.42","572.2","592.1","V12.51","432.1","723.4","369.4","873.41","V45.4","585.9","198.82","782.1","V10.03","396.2","300.00","331.82","420.99","276.50","E930.9","410.91","038.42","997.2","721.3","368.16","715.90","250.01","041.12","332.0","314.01","V85.42","780.52","288.50","E888.9","070.54","038.9","E950.9","V10.83","585.6","560.2","996.64","812.01","238.71","785.6","238.7","V54.19","482.1","851.80","440.21","303.00","574.00","441.01","305.61","996.82","286.6","490","426.13","V49.72","484.6","458.21","309.81","V46.3","537.82","571.5","802.0","518.81","211.1","789.07","493.90","278.03","794.31","416.9","314.00","478.5","V45.89","285.21","E879.1","054.2","286.9","723.1","E849.8","272.4","998.0","251.8","414.01","E858.3","790.93","041.5","707.15","276.1","996.61","E935.3","555.0","426.52","780.93","465.9","277.39","530.20","553.21","438.9","041.10","996.59","345.80","571.8","437.9","250.92","211.4","780.99","424.1","E881.0","428.43","288.8","041.89","244.1","787.02","557.9","730.17","456.8","786.3","997.1","891.0","590.10","E944.4","155.0","425.5","585.3","225.2","345.90","440.20","511.89","V44.3","437.3","288.3","453.82","807.01","963.0","807.09","295.72","873.44","V12.09","813.41","426.82","305.03","E939.4","276.4","275.3","303.01","438.83","285.9","519.8","E935.9","958.7","824.0","038.11","198.0","569.41","440.23","V10.3","447.6","456.1","722.52","802.4","434.91","995.91","V43.64","284.19","516.8","722.91","289.84","722.0","577.2","719.41","997.4","V10.72","V64.1","112.4","569.62","801.22","V13.02","414.04","211.3","723.0","300.01","337.9","729.73","V49.87","530.82","136.3","569.82","410.81","996.63","410.11","519.2","805.04","151.0","250.13","852.22","569.84","403.01","562.00","805.05","E938.3","805.6","805.08","853.06","403.00","250.11","996.67","759.82","193","518.52","822.0","801.20","590.80","411.0","443.24","485","150.5","E980.4","721.90","042","999.32","345.70","324.0","996.71","201.90","335.20","801.21","305.53","345.50","562.13","433.31","444.1","394.0","414.10","458.2","428.42","212.7","295.62","191.2","864.02","V64.42","205.01","823.32","401.0","574.91","304.71","435.2","162.2","487.0","070.51","250.20","038.40","525.8","996.04","493.91","038.3","E939.2","188.9","865.02","556.6","806.00","478.74","996.76","921.2","228.04","600.0","E887","070.44","969.0","250.22","453.2","567.23","E968.2","733.82","530.2","410.21","197.1","998.3","493.92","154.1","582.9","038.19","552.21","711.05","162.9","441.3","852.26","309.9","157.8","156.1","429.5","567.38","513.0","292.12","441.02","999.89","531.00","996.85","420.91","291.0","E819.0","V42.7","440.31","623.8","357.0","263.1","934.9","851.81","746.4","441.7","728.86","522.4","528.3","537.83","404.91","996.65","567.21","456.20","733.99","682.0","197.3","851.82","198.4","812.21","806.05","220","850.11","805.02","850.5","162.5","415.12","965.01","726.10","560.39","805.07","753.0","750.3","414.12","853.00","290.41","996.02","707.0","530.21","348.9","813.42","820.21","433.11","E966","403.11","305.02","807.04","204.00","707.24","532.00","038.10","805.01","540.0","853.01","619.1","162.3","423.8","296.50","E934.8","996.2","378.54","446.5","864.03","428.33","070.71","038.12","345.3","865.09","337.1","428.41","V45.76","410.51","555.2","155.1","682.4","595.0","865.01","150.8","864.15","V64.3","567.31","396.8","870.8","155.2","801.01","446.6","575.12","410.41","287.3","805.06","E888.1","799.1","820.09","205.10","447.0","810.02","966.3","374.30","493.00","528.01","237.5","965.1","704.8","245.2","852.06","443.22","432.9","820.22","482.84","958.92","853.02","552.3","747.81","820.8","537.84","807.06","852.20","437.2","358.01","530.4","852.02","865.04","191.9","410.01","191.3","410.31","865.03","441.03","851.86","191.8","286.0","349.31","434.01","191.1","153.6","534.40","V58.11","410.61"]
genders = ["m", "f", "o"]
care_sites = ["ip", "op", "ed", "icu"]
races = ["w", "b", "o"]
ages = ["0-18","19-34","35-50","51-65","65+"]

with open("data/fake_data.csv", 'w') as datafile:
    datafile.write(','.join(header) + "\n")

    # Select random choice from each demographics list
    for i in range(0, visits_to_generate):
        record = [
            str(i),
            random.choice(genders),
            random.choice(care_sites),
            random.choice(races),
            random.choice(ages)
        ]
        
        # Randomly set LOS between 1 & 12 days, evaluate if >=6 day threshold
        los_over_6 = 0
        los = random.randint(1,12)
        if los >= 6:
            los_over_6 = 1

        # Add LOS results to record
        record.append(str(los_over_6))
        record.append(str(los))

        # Randomly generate diagnoses - 10% chance that any diagnosis is positive
        for j in range(7, len(header)):
            has_dx = 0
            chance_of_dx = random.randint(0, 10)
            if chance_of_dx > 9:
                has_dx = 1
            record.append(str(has_dx))

        datafile.write(','.join(record) + "\n")
